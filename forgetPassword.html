<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta content="耘存科技" http-equiv="keywords">
	<meta name="description" content="耘存科技">
	<meta name="viewport" content="width=device-width,user-scalable=no, initial-scale=1">

	<!-- favicons -->
	<link rel="apple-touch-icon" href="./images/favicon-apple.png">
	<link rel="icon" href="">
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="http://cdn.bootstrapmb.com/bootstrap/4.1.3/css/bootstrap.min.css">
	<!-- Material design icons CSS -->
	<link rel="stylesheet" href="./css/static/material-icons.css">
	<!-- aniamte CSS -->
	<link rel="stylesheet" href="./css/static/animate.css">
	<!-- app CSS -->
	<link id="theme" rel="stylesheet" href="./css/static/purplesidebar.css" type="text/css">
	<title>忘记密码</title>

	<style>
		body {
			background-image: url("./images/block7.png");
			background-size: 100% 200%;
		}

		.card {
			background-color: transparent;
		}

		.form-control {
			width: 80%;
			display: block;
			margin: 4px auto;
			border-radius: inherit;
		}

		.c-333 {
			margin-top: 4px;
		}

		input::-webkit-input-placeholder,
		textarea::-webkit-input-placeholder {
			color: #fff !important;
			font-size: 16px;
		}

		.line {
			border-top: 1px solid #424141;
			width: 70%;
			margin-top: 1px;
		}


		.btn1 {
			position: relative;
			display: inline-block;
			width: 100%;
			height: 100%;
			overflow: hidden;
			text-align: center;
			font-size: 18px;
			line-height: 130px;
			vertical-align: center;
			color: seashell;
			border-radius: 3px;

		}

		.btn1 input {
			position: absolute;
			left: 0;
			top: 0;
			opacity: 0;
		}

		.phone {
			width: 1.1rem;
			position: absolute;
			top: 20px;
			left: -120px;
		}

		.code {
			width: 1.1rem;
			position: absolute;
			top: 20px;
			left: -120px;
		}

		.btncode {
			color: #fff;
			border: 1px solid #fff;
		}

		.jie {
			color: #fff;
			font-family: cursive;
		}

		.mi {
			width: 1.1rem;
			position: absolute;
			top: 20px;
			left: -120px;
		}

		.mi2 {
			width: 1.1rem;
			position: absolute;
			top: 20px;
			left: -120px;
		}

		/* ------------头部导航------------------- */
		.top_bg {
			position: fixed;
			z-index: 999;
			top: 0;
			left: 0;
			width: 100%;
			/* background-color: #fff; */
			background-color: #0083c3;
			padding: 1.1rem 3%;
		}

		.top_logo {
			float: left;
			width: 80%;
			height: 1.3rem;
			position: relative;
		}

		.top_logo img {
			display: block;
			max-width: 100%;
			max-height: 2.8rem;
			position: absolute;
			left: -10px;
			top: 50%;
			border: none;
			transform: translate(0, -50%);
			-o-transform: translate(0, -50%);
			-ms-transform: translate(0, -50%);
			-moz-transform: translate(0, -50%);
			-webkit-transform: translate(0, -50%);
		}

		/* -----------头部导航------------------- */
		#tip {
			font-size: 14px;
		}
	</style>


</head>

<body class="fixed-header sidebar-right-close sidebar-left-close">

	<div class="top_bg">
		<div class="top_main fix">
			<div class="top_logo">
				<a href="index.html"><img src="images/yclogo2.png" /></a>
			</div>
			<div style="float:right">
				<span class="go_back_wrap" style="color: #fff;"> < 返回 </span>
			</div>
		</div>
	</div>

	<div class="container h-100 h-sm-auto align-items-center">
		<div class="row align-items-center h-100 h-sm-auto">
			<div class="col-12 col-sm-8 col-md-6 col-lg-5 col-xl-4 mx-auto text-center">
				<br /><br /><br />
				<h4 class="font-weight-light mb-4 text-white text-center" style="margin-top: 20px; font-family: cursive;">输入您要修改的密码</h4>
				<br /><br /><br />
				<div class="card mb-4" style="margin-top: -30px;">
					<div class="card-body p-0" style="margin-top: -10%;">
						<!--输入手机号-->
						<div class="input">
							<span style="position: relative;">
								<img src="./images/static/phone.png" alt="" class="phone">
							</span>
							<input type="text" id="regPhone" oninput="preSql(this)" onkeyup="CheckPhone(this.value)"
								class="form-control text-center form-control-lg border-0" placeholder="输入有效的手机号"
								style=" background-color: transparent; color:#fff; font-family: cursive;">
							<!-- <hr class="line" /> -->
							<span id="err_msgPhone"></span>
						</div>
						<div class="input">
							<span style="position: relative;">
								<img src="./images/static/code.png" alt="" class="code">
							</span>
							<input type="text" id="yanZM" oninput="preSql(this)"
								class="form-control text-center form-control-lg border-0" placeholder="输入验证码"
								style=" background-color: transparent; color:#fff; font-family: cursive;">
							<!-- <hr class="line" /> -->
							<span id="msgYanZM"></span>
							<!--<span id="sendYzm" >免费获取验证码</span>-->
							<input type="button" class="btn btn-outline-primary c-333 text-c js-code btncode"
								value="获取验证码" id="sendYzm" style="font-family: cursive;color: #fff">
						</div>
						<!--输入密码 开始-->
						<label for="inputPassword" class="sr-only">输入密码</label>
						<span style="position: relative;">
							<img src="./images/static/mi.png" alt="" class="mi">
						</span>
						<table border="0" cellpadding="0" cellspacing="0">
							<tr align="center">
								<td id="pwd_Weak" class="pwd pwd_c"> </td>
								<td id="pwd_Medium" class="pwd pwd_c pwd_f"></td>
								<td id="pwd_Strong" class="pwd pwd_c pwd_c_r"> </td>
							</tr>
						</table>
						<input type="password" id="inputPassword" oninput="preSql(this)"
							onkeyup="CheckQiang(this.value)" maxlength="16"
							class="form-control text-center form-control-lg border-0" placeholder="输入密码(6~16位字符)"
							required="" style=" background-color: transparent; color:#fff; font-family: cursive;">
						<!-- <hr class="line" /> -->
						<div style="width: 70%; margin: 0 auto;">
							<span id="err_msgPsw"></span>
						</div>
						<!--输入密码 结束-->
						<!--再次输入密码-->
						<label for="inputPassword2" class="sr-only">再次输入密码</label>
						<span style="position: relative;">
							<img src="./images/static/mi.png" alt="" class="mi2">
						</span>
						<input type="password" id="inputPassword2" oninput="preSql(this)"
							onkeyup="CheckQiang1(this.value)" class="form-control text-center form-control-lg border-0"
							placeholder="再次输入密码" required=""
							style=" background-color: transparent; color:#fff; font-family: cursive;">
						<!-- <hr class="line" /> -->
						<!-- <hr class="my-0"> -->
						<span id="password_2"></span>
					</div>
				</div>
				<div class="my-4 row">
					<div class="col-12  text-center">
						<div class="custom-control custom-checkbox">
							<input type="checkbox" class="custom-control-input" id="customCheck111" checked>
							<!-- <label class="custom-control-label text-white" for="customCheck111"><span
                                    class="jie">接受</span> <a href="">我们的权力和条款</a>.</label> -->
							<label class="custom-control-label" for="customCheck111"><span class="jie">接受</span> <a
									href="" class="jie">我们的权力和条款</a></label>
						</div>
					</div>
				</div>
				<div class="text-center">
					<a class=" btn btn-primary pink-gradient" onclick="mr_verify()" value="修改" id="my_button"
						style="width: 80%; margin-bottom: 15px; font-family: cursive; font-size: 20px">修改</a>
					<!-- <a href="./login.html" class="btn btn-primary pink-gradient" style="width: 80%; font-family: cursive; font-size: 20px">登录</a> -->
				</div>
				<br>
			</div>
		</div>
	</div>
	<!-- content page ends -->
	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="./js/static/jquery-3.2.1.min.js"></script>
	<script src="./js/static/popper.min.js"></script>
	<script src="http://cdn.bootstrapmb.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
	<!-- Cookie jquery file -->
	<script src="./js/static/jquery.cookie.js"></script>
	<!-- swiper slider jquery file -->
	<script src="./js/static/swiper.min.js"></script>
	<!-- Application main common jquery file -->
	<script src="./js/static/main.js"></script>
	<!-- page specific script -->
	<!-- 验证码 -->
	<script src="./js/static/verification_code.js"></script>
	<!--简单弹出框-->
	<script src="./js/static/message.js"></script>
	<!-- 过滤器SQL -->
	<script src="./js/static/filterSQL.js"></script>
	<script>
		//正则表达式
		function length(str) {
			return str.replace(/(^\s*)|(\s*$)/g, "").length;
		}
		function CheckStr(str) {
			var regx = /['"#$%&\^*》>,."<《？，。！@#￥%……’”：=!~()（）{}:;|?、·`【】/；]/;
			rs = regx.exec(str);
			if (rs != null) {
				return false;
			}
			else {
				return true;
			}
		}
		//输入密码时判断
		function CheckQiang(pwd) {
			var pass_input = $('#inputPassword').val()
			var password = document.getElementById("inputPassword");
			if (password.value === '' || password.value === null) {
				$("#err_msgPsw").html("*密码不能为空*");
				$("#err_msgPsw").css("color", "red");
				return;
			} else if (pass_input.length < 6) {
				$("#err_msgPsw").html("*密码不能小于6*");
				$("#err_msgPsw").css("color", "red");
				return;
			} else if (pass_input.length > 16) {
				$("#err_msgPsw").html("*密码不能大于16*");
				$("#err_msgPsw").css("color", "red");
				return;
			} else if (password.value !== '' || password.value !== null) {
				$("#err_msgPsw").html("");
			}

			var Mcolor, Wcolor, Scolor;
			var m = 0;
			var Modes = 0;
			for (var i = 0; i < pwd.length; i++) {
				var charType = 0;  // 字符类型 ASCII类型
				var t = pwd.charCodeAt(i);  //返回字符串pwd第i个字符的 Unicode 编码
				if (t >= 48 && t <= 57) { charType = 1; }
				else if (t >= 65 && t <= 90) { charType = 2; }
				else if (t >= 97 && t <= 122) { charType = 4; }
				else { charType = 4; }
				Modes |= charType;
			}
			for (var i = 0; i < 4; i++) {
				if (Modes & 1) { m++; }
				Modes >>>= 1;
			}
			if (pwd.length <= 4) { m = 1; }
			if (pwd.length <= 0) { m = 0; }
			switch (m) {
				case 1:                       // 如果输入的密码位数少于5位，那么就判定为弱
					Wcolor = "pwd pwd_Weak_c";    //如果输入的密码只由数字、小写字母、大写字母或其它特殊符号当中的一种类型组成，则判定为弱
					Mcolor = "pwd pwd_c";
					Scolor = "pwd pwd_c pwd_c_r";
					document.getElementById("err_msgPsw").style.color = "red";
					document.getElementById("err_msgPsw").style.display = "block";
					document.getElementById("err_msgPsw").innerHTML = "*您的密码强度太弱了";
					break;
				case 2:   //如果密码由数字、小写字母、大写字母或其它特殊符号当中的两种类型组成，则判定为中
					Wcolor = "pwd pwd_Medium_c";
					Mcolor = "pwd pwd_Medium_c";
					Scolor = "pwd pwd_c pwd_c_r";
					document.getElementById("err_msgPsw").style.color = "	Green";
					document.getElementById("err_msgPsw").style.display = "block";
					document.getElementById("err_msgPsw").innerHTML = "*您的密码强度一般";
					break;
				case 3: //如果密码由数字、小写字母、大写字母或其它特殊符号当中的三种类型以上组成，则判定为强
					Wcolor = "pwd pwd_Strong_c";
					Mcolor = "pwd pwd_Strong_c";
					Scolor = "pwd pwd_Strong_c pwd_Strong_c_r";
					document.getElementById("err_msgPsw").style.color = "black";
					document.getElementById("err_msgPsw").innerHTML = "*您的密码很强 很不错！";
					break;
				default:
					Wcolor = "pwd pwd_c";
					Mcolor = "pwd pwd_c pwd_f";
					Scolor = "pwd pwd_c pwd_c_r";
					document.getElementById("err_msgPsw").style.display = "none";
					break;
			}
			document.getElementById('pwd_Weak').className = Wcolor;
			document.getElementById('pwd_Medium').className = Mcolor;
			document.getElementById('pwd_Strong').className = Scolor;

		}
		//再次输入密码判断
		function CheckQiang1(pwd) {
			var password = document.getElementById("inputPassword");
			var passwordRepeat = document.getElementById("inputPassword2");
			if (passwordRepeat.value === '' || passwordRepeat.value === null) {
				$("#password_2").html("*确认密码不能为空*");
				$("#password_2").css("color", "red");
				return;
			} else if (password.value !== passwordRepeat.value) {
				$("#password_2").html("*密码设置前后不一致*");
				$("#password_2").css("color", "red");
				return;
			} else if (password.value === passwordRepeat.value) {
				$("#password_2").html("");
			}
		}
		//输入手机号时判断
		function CheckPhone() {
			var regPhone = document.getElementById("regPhone");
			if (regPhone.value === '' || regPhone.value === null) {
				$("#err_msgPhone").html("*手机号不能为空*");
				$("#err_msgPhone").css("color", "red");
				return;
			} else if (isNaN(regPhone.value)) {//验证手机号格式
				$("#err_msgPhone").html("*手机号请输入数字*");
				$("#err_msgPhone").css("color", "red");
				return;
			} else if (regPhone.value.length !== 11) {
				$("#err_msgPhone").html("*手机号是11个数字*");
				$("#err_msgPhone").css("color", "red");
				return;
			} else {
				$("#err_msgPhone").html("");
				return;
			}

		}

		'use strict';
		var mySwiper = new Swiper('.swiper-signin', {
			slidesPerView: 1,
			spaceBetween: 0,
			autoplay: true,
			pagination: {
				el: '.swiper-pagination',
				clickable: true,
			}
		});
	</script>
	<script>
		var result;
		//点击事件注册按钮
		function mr_verify() {
			//获取表单对象
			var chackbox = document.getElementById("customCheck111");

			//判断是否有勾选条约复选框
			if ($("#customCheck111").is(":checked") == false) {
				ShowMsg("请勾选 接受我们的权力和条款")
				return;
			}
			//密码
			var pass_input_1 = $('#inputPassword').val()
			//再次输入密码
			var pass_input_2 = $('#inputPassword2').val()
			//获取输入的验证码的 值
			var yanZM = $("#yanZM").val();
			//获取请求验证码的ajax并赋值
			var result_1 = result
			console.log('::::::---------', yanZM);
			console.log('::::::---------', result);
			//验证成功执行ajax
			if (pass_input_1.length > 5) {
				if (pass_input_1 === pass_input_2) {
					//判断校验码是否为空
					if (yanZM == null || yanZM == '') {
						$("#msgYanZM").html("验证码不能为空!");
						$("#msgYanZM").css("color", "red");
						return;
					} else if (yanZM == result) {
						//console.log("result_1",result_1)
						$.ajax({
							type: "post",
							url: "http://61.147.123.84:9000/v1/forgetpassword",
							dataType: 'json',
							data: {
								phone: $("#regPhone").val(),
								password: $("#inputPassword").val()
							},
							success: function (data) {
								if (data.Msg == 'ok') {
									ShowSuccess('修改成功 !')
									setTimeout(() => {
										window.location.href = './login.html'
									}, 1000)
								} else {
									ShowFailure(data.Msg)
									setTimeout(() => {
										window.location.href = './register.html'
									}, 1000)
								}
							}
						})
					} else {
						$("#msgYanZM").html("验证码有误,请重试！");
						$("#msgYanZM").css("color", "red");
						return;
					}
				} else {
					$("#password_2").html("*密码设置前后不一致！*");
					$("#password_2").css("color", "red");
					return;
				}
			} else {
				$("#password_1").html("*密码长度必须大于5！*");
				$("#password_1").css("color", "red");
				return;
			}
		}
		// 注册时，手机号 按正则格式输入 , 且检查已存在否
		$("#regPhone").focus(function () {
			$("#err_msgPhone").html("")
		})
		//发送验证码  发起ajax请求,后台拦截这个请求

		$("#regPhone").blur(function () {
			var reg1 = /^1[3|4|5|7|8|9][0-9]\d{8}$/;
			if (!reg1.test(this.value)) {  //如果当前用户输入的值 非真（不符合手机号规则）
				ShowFailure("请输入正确的手机号！")
			} else if (reg1.test(this.value)) {
				$("#sendYzm").click(function () {
					var tel = $("#regPhone").val();
					$.ajax({
						url: "http://61.147.123.84:9000/v1/identifycode",
						type: "GET",
						dataType: 'json',
						async: false,
						data: {
							phone: tel
						},
						success: function (data) {
							//console.log(data);
							result = data.Msg
						}
					})
				})
			}
		})

		$('.go_back_wrap').on('click',function () { // 返回
			window.history.go(-1)
		})
	</script>
</body>

</html>